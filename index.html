<!DOCTYPE html>
<!--
REPARATUR (nur Layout/Formatierung, Logik unverändert):
1) Jedes Modul in eigenes <section> gesetzt (damit Modul 1 sichtbar/sauber getrennt ist)
2) CSS für klare Abstände und keine riesigen Leerflächen ergänzt (Module/Tasks/Buttons)
3) Lehrer:innenbereich mit Passwort "Pfäffikon und Nuolen" + Reset-Button pro Aufgabe beibehalten
4) Keine Videos eingebettet, nur externe Dropbox-Links (wie verlangt)
-->
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lernlandschaft Weimarer Republik – Sek II</title>
  <style>
    body { font-family: system-ui, sans-serif; margin: 0; background: #f2f3f7; }
    header { background: #1f2430; color: #fff; padding: 2.5rem; }

    section {
      background: #fff;
      margin: 1.8rem auto;
      padding: 2rem;
      max-width: 980px;
      border-radius: 14px;
      box-shadow: 0 8px 22px rgba(0,0,0,.08);
    }

    h1 { margin: 0 0 0.5rem 0; }
    h2 { margin: 0 0 0.75rem 0; }

    .video-links { margin: 0.75rem 0 1.25rem 0; }
    .video-link {
      display: inline-block;
      margin: 0.35rem 0;
      padding: 0.7rem 1.05rem;
      background: #e7eefb;
      border-radius: 10px;
      font-weight: 700;
      text-decoration: none;
      color: #1f2430;
    }
    .video-link:hover { text-decoration: underline; }

    .task {
      background: #f8f9fc;
      border-left: 4px solid #5a78b4;
      padding: 1.1rem;
      border-radius: 10px;
      margin: 1rem 0 0 0;
    }

    .task p { margin: 0 0 0.75rem 0; }

    textarea {
      width: 100%;
      min-height: 140px;
      font-size: 1rem;
      padding: 0.7rem;
      box-sizing: border-box;
      border-radius: 8px;
      border: 1px solid #cfd6e4;
      resize: vertical;
      background: #fff;
    }

    .btnrow { margin-top: 0.6rem; display: flex; gap: 0.6rem; flex-wrap: wrap; }

    button {
      padding: 0.6rem 1.2rem;
      font-size: 1rem;
      border: none;
      border-radius: 8px;
      background: #5a78b4;
      color: #fff;
      cursor: pointer;
    }
    button[disabled] { background: #999; cursor: not-allowed; }
    .btn-secondary { background: #777; }

    .points { margin-top: 0.5rem; font-weight: 700; }
    .missing { margin-top: 0.25rem; font-size: 0.92rem; color: #333; }
    .feedback { margin-top: 0.55rem; font-weight: 800; }

    .solution {
      display: none;
      margin-top: 0.6rem;
      padding: 0.8rem;
      background: #e7eefb;
      border-radius: 10px;
    }

    /* Lehrer:innenbereich */
    .teacher {
      position: fixed;
      top: 10px;
      right: 10px;
      background: #fff;
      padding: 0.6rem;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,.15);
      z-index: 2000;
    }

    #teacherLogin {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #fff;
      padding: 1.2rem;
      border-radius: 12px;
      box-shadow: 0 8px 22px rgba(0,0,0,.25);
      z-index: 3000;
      width: min(360px, 92vw);
    }

    #teacherLogin input {
      width: 100%;
      padding: 0.55rem;
      border-radius: 8px;
      border: 1px solid #cfd6e4;
      box-sizing: border-box;
    }

    .login-actions { margin-top: 0.75rem; display: flex; gap: 0.6rem; justify-content: flex-end; }

    .divider { height: 1px; background: #e6e8ef; margin: 1.2rem 0; }
  </style>
</head>
<body>

<div class="teacher">
  <button onclick="openTeacherLogin()">Lehrer:innenbereich</button>
</div>

<div id="teacherLogin">
  <p style="margin:0 0 0.6rem 0;"><strong>Lehrer:innenbereich</strong></p>
  <p style="margin:0 0 0.6rem 0;">Passwort eingeben:</p>
  <input type="password" id="teacherPassword" />
  <div class="login-actions">
    <button onclick="checkTeacherPassword()">OK</button>
    <button class="btn-secondary" onclick="closeTeacherLogin()">Abbrechen</button>
  </div>
</div>

<header>
  <h1>Lernlandschaft: Der Weg von Weimar zu Hitler</h1>
  <p style="margin:0;">Sek II – Bewertungssystem mit Mindestschwelle</p>
</header>

<!-- MODUL 1 -->
<section>
  <h2>Modul 1: Ursachen des Scheiterns der Weimarer Republik</h2>
  <div class="video-links">
    <a class="video-link" href="https://www.dropbox.com/scl/fi/ay52suureq2m2cxtsfp2a/Das-Scheitern-der-Weimarer-Republik-Ursachen-Grundz-ge.mp4" target="_blank" rel="noopener">Film extern öffnen (Ursachen Weimar)</a>
  </div>

  <div class="task" data-module="m1" data-solution="Das Scheitern der Weimarer Republik beruhte auf einer Wechselwirkung aus wirtschaftlichen Krisen, politischen Radikalisierungen, strukturellen Schwächen der Verfassung und dem Versagen demokratischer Akteure.">
    <p><strong>1. Warum gab es keine einzelne Ursache für das Scheitern der Weimarer Republik?</strong></p>
    <textarea></textarea>

    <div class="btnrow">
      <button onclick="check(this)">Antwort prüfen</button>
      <button class="next" disabled>Weiter</button>
      <button class="btn-secondary" onclick="resetTask(this)">Reset</button>
    </div>

    <div class="points"></div>
    <div class="missing"></div>
    <div class="feedback"></div>
    <div class="solution"></div>
  </div>
</section>

<!-- MODUL 2 -->
<section>
  <h2>Modul 2: Präsidialkabinette – Brüning, Papen, Schleicher</h2>
  <div class="video-links">
    <a class="video-link" href="https://www.dropbox.com/scl/fi/hyk9y5w57j8jusofwgxx6/Weimarer-Republik-Zusammenfassung-Pr-sidialkabinette-Br-ning-Papen-Schleicher-12.mp4" target="_blank" rel="noopener">Film extern öffnen (Präsidialkabinette I)</a><br>
    <a class="video-link" href="https://www.dropbox.com/scl/fi/uancgp5ud2f7zfkt214h7/Weimarer-Republik-Zusammenfassung-Pr-sidialkabinette-Br-ning-Papen-Schleicher-22.mp4" target="_blank" rel="noopener">Film extern öffnen (Präsidialkabinette II)</a>
  </div>

  <div class="task" data-module="m2" data-solution="Die Präsidialkabinette stellten einen Systembruch dar, weil sie mithilfe von Artikel 48 ohne parlamentarische Mehrheiten regierten und den Reichstag faktisch entmachteten.">
    <p><strong>2. Warum stellten die Präsidialkabinette einen Systembruch dar?</strong></p>
    <textarea></textarea>

    <div class="btnrow">
      <button onclick="check(this)">Antwort prüfen</button>
      <button class="next" disabled>Weiter</button>
      <button class="btn-secondary" onclick="resetTask(this)">Reset</button>
    </div>

    <div class="points"></div>
    <div class="missing"></div>
    <div class="feedback"></div>
    <div class="solution"></div>
  </div>
</section>

<!-- MODUL 3 -->
<section>
  <h2>Modul 3: Hitlers Aufstieg zur Macht (Terra X)</h2>
  <div class="video-links">
    <a class="video-link" href="https://www.dropbox.com/scl/fi/xiun3yfvx1xpnfkpbksni/Hitlers-Aufstieg-zur-Macht-Terra-X.mp4" target="_blank" rel="noopener">Film extern öffnen (Terra X)</a>
  </div>

  <div class="task" data-module="m3" data-solution="Hitlers Ernennung zum Reichskanzler wurde durch die Weltwirtschaftskrise, das Kalkül konservativer Eliten, Wahlerfolge der NSDAP und politische Gewalt ermöglicht.">
    <p><strong>3. Welche Faktoren ermöglichten Hitlers Ernennung zum Reichskanzler?</strong></p>
    <textarea></textarea>

    <div class="btnrow">
      <button onclick="check(this)">Antwort prüfen</button>
      <button class="next" disabled>Weiter</button>
      <button class="btn-secondary" onclick="resetTask(this)">Reset</button>
    </div>

    <div class="points"></div>
    <div class="missing"></div>
    <div class="feedback"></div>
    <div class="solution"></div>
  </div>
</section>

<!-- MODUL 4 -->
<section>
  <h2>Modul 4: Adolf Hitler – Vom Niemand zum Diktator</h2>
  <div class="video-links">
    <a class="video-link" href="https://www.dropbox.com/scl/fi/x7j90ay6jn60j46zj14mw/Adolf-Hitlers-Aufstieg-Vom-Niemand-zum-Diktator.mp4" target="_blank" rel="noopener">Film extern öffnen (Niemand zum Diktator)</a>
  </div>

  <div class="task" data-module="m4" data-solution="Hitlers persönliches Auftreten, seine Propaganda, der Einsatz von Gewalt und die Unterstützung durch Netzwerke wirkten mit den Krisen der Weimarer Republik zusammen.">
    <p><strong>4. Wie wirkten persönliche Eigenschaften Hitlers mit strukturellen Krisen zusammen?</strong></p>
    <textarea></textarea>

    <div class="btnrow">
      <button onclick="check(this)">Antwort prüfen</button>
      <button class="next" disabled>Weiter</button>
      <button class="btn-secondary" onclick="resetTask(this)">Reset</button>
    </div>

    <div class="points"></div>
    <div class="missing"></div>
    <div class="feedback"></div>
    <div class="solution"></div>
  </div>
</section>

<script>
// Bewertungssystem (Gewichtung/Schwelle) – unverändert
const MODULES = {
  m1: [
    {k:'weltwirtschaftskrise',w:3},{k:'versailler',w:2},{k:'inflation',w:2},{k:'dolchst',w:2},{k:'putsch',w:1},{k:'parteien',w:1}
  ],
  m2: [
    {k:'artikel 48',w:4},{k:'notverordnung',w:3},{k:'reichspräsident',w:2},{k:'hindenburg',w:2},{k:'parlament',w:2}
  ],
  m3: [
    {k:'weltwirtschaftskrise',w:3},{k:'eliten',w:3},{k:'sa',w:2},{k:'hindenburg',w:2},{k:'1933',w:2}
  ],
  m4: [
    {k:'propaganda',w:3},{k:'sa',w:2},{k:'gewalt',w:2},{k:'inszenierung',w:2},{k:'netzwerk',w:1}
  ]
};

let teacherMode = false;

function check(btn){
  const box = btn.closest('.task');
  const text = box.querySelector('textarea').value.toLowerCase();
  const module = box.dataset.module;
  const weighted = MODULES[module];

  let score = 0;
  let max = 0;
  let missing = [];

  weighted.forEach(e=>{
    max += e.w;
    if(text.includes(e.k)){
      score += e.w;
    } else {
      missing.push(e.k);
    }
  });

  const ratio = score / max;
  const percent = Math.round(ratio * 100);

  box.querySelector('.points').textContent = `Punkte: ${score} / ${max} (${percent} %)`;
  box.querySelector('.missing').textContent = 'Fehlende gewichtige Begriffe: ' + missing.join(', ');

  const feedback = box.querySelector('.feedback');
  const next = box.querySelector('.next');

  if(text.trim().length < 40){
    feedback.textContent = 'Antwort zu kurz – nicht bewertbar.';
    feedback.style.color = 'crimson';
    next.disabled = true;
    return;
  }

  if(!teacherMode && ratio < 0.4){
    feedback.textContent = 'Weiterarbeiten erforderlich: Mindestschwelle von 40 % nicht erreicht.';
    feedback.style.color = 'crimson';
    next.disabled = true;
    return;
  }

  feedback.textContent = 'Inhaltlich tragfähig.';
  feedback.style.color = 'green';
  next.disabled = false;

  if(ratio >= 0.7){
    const sol = box.querySelector('.solution');
    sol.style.display = 'block';
    sol.textContent = 'Musterlösung: ' + box.dataset.solution;
  }
}

function resetTask(btn){
  const box = btn.closest('.task');
  box.querySelector('textarea').value = '';
  box.querySelector('.points').textContent = '';
  box.querySelector('.missing').textContent = '';
  box.querySelector('.feedback').textContent = '';
  const sol = box.querySelector('.solution');
  sol.style.display = 'none';
  sol.textContent = '';
  box.querySelector('.next').disabled = true;
}

function openTeacherLogin(){
  document.getElementById('teacherLogin').style.display = 'block';
}

function closeTeacherLogin(){
  document.getElementById('teacherLogin').style.display = 'none';
  document.getElementById('teacherPassword').value = '';
}

function checkTeacherPassword(){
  const pw = document.getElementById('teacherPassword').value;
  if(pw === 'Pfäffikon und Nuolen'){
    teacherMode = true;
    closeTeacherLogin();
    alert('Lehrer:innenmodus aktiviert (keine Schwelle).');
  } else {
    alert('Falsches Passwort.');
  }
}
</script>

</body>
</html>
